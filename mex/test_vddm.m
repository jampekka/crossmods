%warning("on", "Octave:language-extension");

dur = 20;
dt = 1/30;

d0 = 63.61;
speed = d0/4.58;

ts = (0:(dur/dt)).*dt;
distance = d0 - speed.*ts;
  
hiker = struct(...
'dt', dt, ...
'std', 0.6384974134032458, ...
'damping', 0.10186865847575911, ...
'scale', 0.2791830034375026, ...
'tau_threshold', 5.544952926633872, ...
'act_threshold', 1.4194944054263028, ...
'pass_threshold', 1.6722899150569444, ...
'dot_coeff', 5.5075638112727745, ...
'ehmi_coeff', 0.8482795240546034, ...
'dist_coeff', 0.4016305596474629 ...
);

tau = distance./speed;
tau_dot = gradient(tau, dt);
[pdf, noncross] = vddm(tau, distance, tau_dot, 0.0, hiker);

noncross
plot(ts, pdf);
